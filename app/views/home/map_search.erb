<script src="http://maps.google.com/maps/api/js?sensor=false" type="text/javascript"></script>

<div class="container-location">
    <div class="row-fluid">
        <%= render 'top_location_search_bar' %>
        <div id="map" style="width: 100%; height: 209px;"></div>

        <div class="out-add-div">
            <ul id="Grid">
                <% if @final_outlets.nil? %>
                    No results found
            <% else %>
                    <% @final_outlets.each_with_index do |outlet, i| %>

                    <% if outlet.is_active == true %>
                    <% outlet.ads.each do |ad| %>
                    <%= render :partial => 'map_poster', :locals => {:outlet => outlet, :ad => ad, :i => i} %>
            <% end %>
            <% end %>
            <% end %>
                <%#= paginate @final_outlets %>
            <% end %>
            </ul>
        </div>
    </div>
</div>


<%= javascript_tag do %>
    <% unless @final_outlets.nil? %>
    locations = <%= @final_outlets.map{|o|[o.latitude, o.longitude]}.uniq.to_json.html_safe %>;
<% end %>
user_location = <%= [@location[:latitude].to_f, @location[:longitude].to_f]%>
    map_initializer(locations, user_location);
<% end %>
